---
title: "Legislative & Presidential Election 2014"
author: "Fahrozi"
date: "6/6/2019"
output: html_document
---


## Exploring Election and Cencus Highly Informative Data Nationally for Indonesia

An Election is one of the main pillars of democracy. it presents the will of the people and determine a country's leadership.

In Indonesia, elections  are highly anticipated,because it provides an opportunity for all people to influence the direction of their country.The results and voting patterns in an election are of great public interest,but often data is not easy to access or work with.This project aims to increase the accessibility of Indonesian election data, which would be particularly beneficial to researchers, journalists and NGOs.

in this project will discuss about Indonesian Legislative Election and Presidential Election 2014. Indonesian Legislative Election were held in Indonesia on 9 april 2014 to elect members of the Regional Representative Council (DPD), Members of People's Representative Council (DPR) and members of the regional assemblies at the provinces. 
In Presidential Election were held In Indonesia on 9 july 2014, according to the 2008 election law,the nominations of the candidates for the presidential election may only be made by a party of coalition of parties) which has at least 20% of the seats in the national parliament (the DPR)  or which received 25% of national votes in the previous national legislative election for the DPR.

##Import csv files

```{ r import csv}
library(readxl)
Legislative_Election <- read_excel("E:/SEMESTER 4 LULUS!!!!/Google Project/Party Election.xls")
```

##data set party
``` {r setup, echo=FALSE, include=TRUE}
library(eechidna)
library(plyr)
library(dplyr)
library(purrr)
library(purrrlyr)
library(knitr)
library(broom)
library(readxl)
glimpse(Legislative_Election) %>% head %>% kable
```

##Party who won the Legislative Election
```{r party who won}
who_won <- Legislative_Election %>%
group_by(PartyNm) %>%
tally() %>%
arrange(desc(n))
who_won %>%
  kable()
```
``` {r ggplotwho_won}
library(ggplot2)
library(scales)
ggplot(who_won, 
       aes(reorder(PartyNm, n),
n)) +
geom_point(size = 2)+
coord_flip() +
scale_y_continuous(labels = comma) +
theme_bw() +
ylab("Total number of electorates") + 
xlab("Party") +
theme(text = element_text(size=10))
```

##dataset total votes


``` {r total-votes}
totalvotes <- read_excel("E:/SEMESTER 4 LULUS!!!!/Google Project/Total Votes percandidates.xlsX")
glimpse(totalvotes)
```

##party received the most votes in Legislative Election

``` {r total-votes2}
totalvotes <- totalvotes %>% mutate(Votes=as.numeric(Votes))
total_votes_for_parties <- totalvotes %>%
  select(PartyNm, Votes) %>%
  group_by(PartyNm) %>%
  summarise(tvotes = sum(Votes)) %>%
  ungroup() %>%
  arrange(desc(tvotes))
total_votes_for_parties %>%
  head %>%
  kable
```

``` {r ggplot total votes}
ggplot(total_votes_for_parties,
       aes(reorder(PartyNm, tvotes),
           tvotes)) +
geom_point(size = 2) +
coord_flip() +
scale_y_continuous(labels = comma) +
theme_bw() +
ylab("Total votes") +
xlab("Party") +
theme(text = element_text(size=10))
```

##party who get many number of seats in Parliament 

``` {r totalseats}
Totalseats <- read_excel("E:/SEMESTER 4 LULUS!!!!/Google Project/Totalseats.xlsx")
glimpse(Totalseats)
```
``` {r Total_seats_for_parties}
Totalseats <- Totalseats %>% mutate(Totseats=as.numeric(Totseats))
Total_seats_for_parties <- Totalseats %>%
  select(PartyNm, Totseats) %>%
  group_by(PartyNm) %>%
  summarise(tot_seats = sum(Totseats)) %>%
  ungroup() %>%
  arrange(desc(tot_seats))
Total_seats_for_parties %>%
  head %>%
  kable
```
``` {r ggplot Total_seats_for_parties}
ggplot(Total_seats_for_parties,
       aes(reorder(PartyNm, tot_seats),
           tot_seats)) +
  geom_point(size = 2) +
  coord_flip() +
  scale_y_continuous(labels = comma) +
  theme_bw() +
  ylab("Total seats") +
  xlab("Party") +
  theme(text = element_text(size=10))
```

##Provinces who get many seats in parliament

``` {r Total_seats_for_provinces}
Total_seats_for_provinces <- Totalseats %>%
  select(Provinces, Totseats) %>%
  group_by(Provinces) %>%
  summarise(tot_seats = sum(Totseats)) %>%
  ungroup() %>%
  arrange(desc(tot_seats))
Total_seats_for_provinces %>%
  head %>%
  kable
```
``` {r ggplot Total_seats_for_provinces}
ggplot(Total_seats_for_provinces,
       aes(reorder(Provinces, tot_seats),
           tot_seats)) +
  geom_point(size = 2) +
  coord_flip() +
  scale_y_continuous(labels = comma) +
  theme_bw() +
  ylab("Total seats") +
  xlab("Provinces") +
  theme(text = element_text(size=10))
```
  
##which candidate did the best?
```{r candidate did the best}

totalvotes <- totalvotes %>% mutate(Votes=as.numeric(Votes))
total_votes_for_candidate <- totalvotes %>%
  select(Name, Votes) %>%
  group_by(Name) %>%
  summarise(tvotes = sum(Votes)) %>%
  ungroup() %>%
  arrange(desc(tvotes))
total_votes_for_candidate %>%
  head %>%
  kable
```
``` {r who won most votes}
who_won_most_votes_prop <- totalvotes %>%
group_by(Electorate,Name) %>%
summarise(sum_votes = sum(Votes)) %>%
mutate(prop_votes = round(sum_votes / sum(sum_votes), 3),
  sum_votes = prettyNum(sum_votes, ",")) %>%
ungroup %>%
arrange(desc(prop_votes))

who_won_most_votes_prop %>%
head %>%
kable
```


##how did each electorate vote in each provinces?

#summarise and compute proportion of votes for PDIP party

``` {r proportion of votes}
totalvotes <- totalvotes %>% mutate(Votes=as.numeric(Votes))
P <- totalvotes %>%
  group_by(Electorate, Provinces) %>%
  summarise (Totalvotes = sum(Votes),
 mutate(ProportionPDIP = round(sum(Votes[PartyNm == "Partai Demokrasi Indonesia Perjuangan"]) / Totalvotes, 3)) %>%
  arrange(desc(ProportionPDIP)) %>%
group_by(Provinces) %>%

do(plots=ggplot(P = .) +  
  aes(x = ProportionPDIP,
      y = reorder(Electorate, ProportionPDIP),
      size = Totalvotes,
      label = Provinces) +
    geom_point()+
    ylab("Electorate") +
    labs(title = .$Provinces)+
    scale_x_continuous("Proportion voting PDIP party",
    label = percent) + 
    scale_size("Number of\nvotes cast",
                label = comma) +
    theme_bw() +
    theme(text = element_text(size=10))
```

```{r plots}   
library(gridExtra)
n <- length(P$plots)
nCol <- floor(sqrt(n))
do.call("grid.arrange", c(P$plots, ncol=ncol))
```

